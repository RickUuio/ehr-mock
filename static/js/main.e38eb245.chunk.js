(this["webpackJsonpehr-mock"]=this["webpackJsonpehr-mock"]||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(15),s=n.n(c),i=(n(35),n(19)),o=n(29),l=n(3),d=n.n(l),u=n(6),b=n(4),j=(n(37),n(8)),p=n(1),h=function(e){var t=e.patient;return Object(p.jsxs)("div",{className:"p-2",children:[Object(p.jsxs)("h4",{style:{color:"yellow"},children:[Object(p.jsx)(j.f,{}),t.firstName," ",t.lastName]}),Object(p.jsxs)("h6",{children:[Object(p.jsx)("span",{className:"badge bg-light text-dark",children:"DOB"})," : ",t.dob,Object(p.jsx)("span",{children:" "}),Object(p.jsx)("span",{className:"badge bg-light text-dark",children:"Gender"})," :"," ",t.gender]}),Object(p.jsxs)("h6",{children:[Object(p.jsx)("span",{className:"badge bg-light text-dark",children:"MRN"})," : ",t.mrn]}),Object(p.jsxs)("h6",{children:[Object(p.jsx)("span",{className:"badge bg-light text-dark",children:"FHIR ID"})," :"," ",t.fhirId]})]})},f=function(e){var t=e.provider;return Object(p.jsxs)("div",{className:"p-2",children:[Object(p.jsxs)("h4",{style:{color:"HotPink"},children:[t.firstName," ",t.lastName," ",Object(p.jsx)(j.g,{})]}),Object(p.jsxs)("h6",{children:[Object(p.jsx)("span",{className:"badge bg-light text-dark",children:"FHIR ID"})," :"," ",t.fhirId]}),Object(p.jsxs)("h6",{children:[Object(p.jsx)("span",{className:"badge bg-light text-dark",children:"UUID "})," :"," ",t.uuid]})]})},m=function(e){var t=e.profileName,n=e.switchProfile;return Object(p.jsxs)("div",{className:"mx-1",children:[Object(p.jsx)("lable",{className:"form-label px-2",children:"FHIR SERVER :"}),Object(p.jsxs)("div",{className:"btn-group mb-2",role:"group","aria-label":"Profile selector",id:"profileGroup",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnProfile",id:"profileEpic",autoComplete:"off",defaultChecked:"Epic"===t,onClick:function(){t="Epic",n("Epic")}}),Object(p.jsx)("label",{className:"btn btn-outline-danger",htmlFor:"profileEpic",children:"Calvin @Epic"}),Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnProfile",id:"profileEpic2",autoComplete:"off",defaultChecked:"Epic2"===t,onClick:function(){t="Epic2",n("Epic2")}}),Object(p.jsx)("label",{className:"btn btn-outline-danger",htmlFor:"profileEpic2",children:"Beverly @Epic"}),Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnProfile",id:"profileLogica",autoComplete:"off",defaultChecked:"Logica"===t,onClick:function(){t="Logica",n("Logica")}}),Object(p.jsx)("label",{className:"btn btn-outline-info",htmlFor:"profileLogica",children:"Beverly @Logica"}),Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnProfile",id:"profileLogica2",autoComplete:"off",defaultChecked:"Logica2"===t,onClick:function(){t="Logica2",n("Logica2")}}),"Logica2"===t?Object(p.jsx)("input",{type:"text",className:"input-group-text text-primary",placeholder:"Patient FHIR ID",size:"14",style:{borderColor:"#5bc0de",fontWeight:"bold"},onBlur:function(e){t="Logica2",n("Logica2",e.target.value)}}):Object(p.jsx)("label",{className:"btn btn-outline-info",htmlFor:"profileLogica2",children:"Enter ID"})]})]})},v=function(e){var t=e.stageName,n=e.switchStage;return Object(p.jsxs)("div",{className:"mx-1",children:[Object(p.jsx)("lable",{className:"form-label px-2",children:"UU SERVER :"}),Object(p.jsxs)("div",{className:"btn-group mb-2",role:"group","aria-label":"Stage selector",id:"stageGroup",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStage",id:"stageStaging",autoComplete:"off",defaultChecked:"staging"===t,onClick:function(){t="staging",n("staging")}}),Object(p.jsx)("label",{className:"btn btn-outline-warning",htmlFor:"stageStaging",children:"Staging"}),Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStage",id:"stageTraining",autoComplete:"off",defaultChecked:"training"===t,onClick:function(){t="training",n("training")}}),Object(p.jsx)("label",{className:"btn btn-outline-success",htmlFor:"stageTraining",children:"Training"}),Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStage",id:"stagePOC",autoComplete:"off",defaultChecked:"poc"===t,onClick:function(){t="poc",n("poc")}}),Object(p.jsx)("label",{className:"btn btn-outline-info",htmlFor:"stagePOC",children:"POC"})]})]})},O=function(e){var t=e.title,n=e.patient,r=e.provider,a=e.profileName,c=e.switchProfile,s=e.stageName,i=e.switchStage;return Object(p.jsx)("header",{children:Object(p.jsx)("div",{id:"navbarTop",children:Object(p.jsxs)("div",{className:"row",children:[Object(p.jsxs)("div",{className:"col-lg-6 col-md-12 order-lg-2",children:[Object(p.jsxs)("h2",{className:"pt-4",children:[Object(p.jsx)(j.d,{style:{color:"#d60c05ee"}})," ",t]}),Object(p.jsxs)("div",{className:"row",children:[Object(p.jsx)("div",{className:"col-lg-auto",children:Object(p.jsx)(m,{profileName:a,switchProfile:c})}),Object(p.jsx)("div",{className:"col-lg-auto",children:Object(p.jsx)(v,{stageName:s,switchStage:i})})]})]}),Object(p.jsx)("div",{className:"col-lg-3 col-md-6 order-lg-1",children:Object(p.jsx)(h,{patient:n})}),Object(p.jsx)("div",{className:"col-lg-3 col-md-6 order-lg-3",children:Object(p.jsx)(f,{provider:r})})]})})})};O.defaultProps={title:"Mock EHR : : Social Care Referrals"};var x=O,g=n(23),N=function(e){var t=e.encounterList,n=e.currentEncounter,r=void 0===n?"smart-2":n,a=e.changeCurrentEncounter,c=e.refreshEncounters;return Object(p.jsxs)("div",{className:"encounter col-md-3 col-lg-2 mx-0 px-0",children:[Object(p.jsxs)("div",{className:"btn btn-default btn-lg btn-block table-hover mx-0",onClick:function(){console.log("Retrieving patient's encounters"),c()},children:["All Encounters",Object(p.jsx)("div",{className:"badge bg-primary mx-2",children:t.length}),Object(p.jsx)(g.a,{})]}),Object(p.jsx)("dl",{children:t.map((function(e,t){var n=e.resource.id===r,c=n?"row list-hover m-0 px-2 text-break selected":"row list-hover m-0 px-2 text-break",s=n?"visible":"invisible";return Object(p.jsxs)("div",{className:c,onClick:function(){return t=e.resource.id,void a(t);var t},children:[Object(p.jsx)("dt",{children:Object(p.jsxs)("a",{href:e.fullUrl,children:[e.resource.id," ",Object(p.jsx)(j.b,{className:s})]})}),Object(p.jsxs)("dd",{children:[Object(p.jsx)("div",{children:e.resource.period.start.split("T")[0]}),Object(p.jsxs)("div",{children:[" ",e.resource.class.display]})]})]},t)}))})]})},y=function(e){var t=e.toggleShowNewReferral,n=e.showNewReferral,r=e.currentEncounter,a=e.sendNotificationUU,c=e.profileName,s=function(){t()};return Object(p.jsx)("div",{className:"encounterSummary",children:Object(p.jsxs)("div",{className:"row pt-2 row-cols-1 row-cols-lg-3",children:[Object(p.jsx)("div",{className:"col mx-auto text-break",children:Object(p.jsxs)("h4",{children:["Current Encounter: ",r]})}),Object(p.jsx)("div",{className:"col",children:n?Object(p.jsx)("button",{className:"btn btn-warning btn-block col mx-1",onClick:s,children:"Cancel New Referral"}):Object(p.jsx)("button",{className:"btn btn-primary btn-block mx-1",onClick:s,disabled:"Logica"!==c&&"Logica2"!==c,children:"Create New Referral"})}),Object(p.jsx)("div",{className:"col",children:Object(p.jsx)("button",{className:"btn btn-primary btn-block col mx-1",onClick:function(){console.log("sending an encounter notification to Unite Us..."),a()},children:"Send Encounter Notification"})})]})})},k=n(24),S=function(e){var t=e.onCreate,n=e.toggleShowNewReferral,a=Object(r.useState)(""),c=Object(b.a)(a,2),s=c[0],i=c[1],o=Object(r.useState)(""),l=Object(b.a)(o,2),d=l[0],u=l[1],j=Object(r.useState)(""),h=Object(b.a)(j,2),f=h[0],m=h[1],v=Object(r.useState)(""),O=Object(b.a)(v,2),x=O[0],g=O[1],N=Object(r.useState)(""),y=Object(b.a)(N,2),S=y[0],C=y[1],w=Object(r.useState)(!1),T=Object(b.a)(w,2),I=T[0],R=T[1],E=function(e){e.preventDefault(),t({serviceType:x,description:S,referredToGroupIds:s,referredFromGroupId:d,networkId:f,attachDocument:I}),i(""),u("demo-hospital"),m("demo-network"),g(""),C(""),R(!1)};return Object(p.jsx)("div",{className:"newReferral",children:Object(p.jsxs)("form",{className:"add-form",onSubmit:E,children:[Object(p.jsxs)("div",{className:"row",children:[Object(p.jsxs)("div",{className:"col-lg-6",children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"SENDING NETWORK"}),Object(p.jsx)("div",{children:Object(p.jsx)("input",{className:"form-select",type:"text",placeholder:"Healthy Demo Network",readOnly:!0,disabled:!0,value:f,onChange:function(e){return m(e.target.value)}})})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"RECEIVING NETWORK"}),Object(p.jsx)("div",{children:Object(p.jsx)("input",{className:"form-select",type:"text",readOnly:!0,disabled:!0,placeholder:"Healthy Demo Network",value:f,onChange:function(e){return m(e.target.value)}})})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"SENDER"}),Object(p.jsx)("div",{children:Object(p.jsx)("input",{className:"form-select",type:"text",readOnly:!0,disabled:!0,placeholder:"Local Hospital Center",value:d,onChange:function(e){return u(e.target.value)}})})]})]}),Object(p.jsxs)("div",{className:"col-lg-6",children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"RECEIPIENT"}),Object(p.jsx)("div",{children:Object(p.jsxs)("select",{className:"form-select",value:s.value,onChange:function(e){return i({value:e.target.value,text:e.target.options[e.target.selectedIndex].text})},children:[Object(p.jsx)("option",{children:"Select an organization ..."}),Object(p.jsx)("option",{value:"15195",children:"Asian Resource - SacramentoWorks"}),Object(p.jsx)("option",{value:"15191",children:"BusRides Sustainable Transportation Act - BusRides Transport"}),Object(p.jsx)("option",{value:"15199",children:"Cumberland Legal Assistance - Youth Services"}),Object(p.jsx)("option",{value:"14742",children:"Housing California - Housing Assistance"}),Object(p.jsx)("option",{value:"15207",children:"James Bentley Treatment Program - Mental Health Skill Building"}),Object(p.jsx)("option",{value:"15211",children:"Kroger - Food Benefits Program"}),Object(p.jsx)("option",{value:"15215",children:"Legal Aid - Housing Law"}),Object(p.jsx)("option",{value:"15219",children:"Planned Parenthood Mohawk Hudson - Saratoga Springs Center - Youth Health Promoters"}),Object(p.jsx)("option",{value:"14733",children:"River City Food Bank - Food Pantry"}),Object(p.jsx)("option",{value:"15183",children:"Santa Fe Medical Clinic - Medical Services"}),Object(p.jsx)("option",{value:"15184",children:"Santa Fe Medical Clinic - Dental Services"}),Object(p.jsx)("option",{value:"15200",children:"St. Mary's Shelter - Men's Emergency Shelter"}),Object(p.jsx)("option",{value:"15488",children:"[STAGING] American Red Cross (Carolina Piedmont Region) Program"}),Object(p.jsx)("option",{value:"15482",children:"[STAGING] Sushi - Spicy Tuna"})]})})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"INITIAL COMMUNICATION"}),Object(p.jsx)("div",{children:Object(p.jsx)("textarea",{className:"form-control",rows:"3",cols:"50",placeholder:"Enter a description for the referral",value:S,onChange:function(e){return C(e.target.value)}})})]}),Object(p.jsx)("div",{className:"form-group",children:Object(p.jsxs)("div",{className:"form-check form-switch mx-2 text-start",children:[Object(p.jsx)("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:I,onChange:function(e){return R(e.target.checked)}}),Object(p.jsxs)("label",{className:"form-check-label",for:"flexSwitchCheckDefault",children:["Attach document to the communication"," ",Object(p.jsx)(k.a,{})]})]})})]})]}),Object(p.jsxs)("div",{className:"row d-inline",children:[Object(p.jsx)("input",{value:"Cancel",className:"btn btn-warning col-md-6 mt-4",onClick:function(){n()},readOnly:!0}),Object(p.jsx)("input",{value:"Submit",className:"btn btn-primary col-md-6 mt-4",onClick:E,readOnly:!0})]})]})})},C=n(10),w=n(21);var T=function(e){var t,n,a,c,s,i,o,l,h,f,m,v,O,x,g,N,y,k,S,T=e.referral,I=e.showFhirSource,R=e.editReferralStatus,E=e.showAddNoteWindow,U=e.baseUrl,P=e.sendUUNotification,D=e.currentStage,A=Object(r.useState)(""),F=Object(b.a)(A,2),L=F[0],q=F[1],M=function(e){I(e,!0)},B=function(e){return e.identifier.find((function(e){return"HTTPS://UNITEUS.COM/IO/STRUCTUREDEFINITION/CBO-UUID"===e.system.toUpperCase()}))},z=function(e){return L===e},_=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=T.trackingItem.full_url,console.log("remove referral: ",t),n="".concat(D.baseUrl,"/mockapi/resource_tracking/delete"),e.next=5,fetch(n,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":D.token},body:JSON.stringify({full_url:t})});case 5:return r=e.sent,e.next=8,r.json();case 8:return a=e.sent,c=a.response,T.trackingItem=null,q(""),console.log("remove item: ",c),e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(U,"/Communication/").concat(t.resource.id),console.log("remove communication: ",n),r="".concat(D.baseUrl,"/mockapi/communication/delete"),e.next=5,fetch(r,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":D.token},body:JSON.stringify({fullUrl:n})});case 5:return a=e.sent,e.next=8,a.json();case 8:return c=e.sent,s=c.response,t.received=!1,T.comNum=T.comNum-1,q(""),console.log("remove item: ",s),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(e){console.log("sending a communication notification to Unite Us..."),P(e,"Communication")};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("tr",{className:"align-middle table-"+function(e){switch(e){case"accepted":return"primary";case"in-progress":return"info";case"rejected":case"failed":return"danger";case"completed":return"success";case"cancelled":return"danger";default:return"light"}}(null===(t=T.Task)||void 0===t||null===(n=t.resource)||void 0===n?void 0:n.status),"data-bs-toggle":"collapse","data-bs-target":"#referral"+T.ServiceRequest.resource.id,"aria-expanded":"false","aria-controls":"referral"+T.ServiceRequest.resource.id,onClick:function(){return e=T.ServiceRequest.resource.id,void q(L===e?"":e);var e},role:"button",children:[Object(p.jsx)("td",{children:T.ServiceRequest.resource.authoredOn}),Object(p.jsx)("td",{children:Object(p.jsxs)("div",{className:"btn btn-outline-primary my-0","data-bs-toggle":"tooltip",title:"Click to edit referral status","data-bs-placement":"top",onClick:function(){var e,t,n,r,a,c;return a=null===(e=T.Task)||void 0===e||null===(t=e.resource)||void 0===t?void 0:t.id,c=null===(n=T.Task)||void 0===n||null===(r=n.resource)||void 0===r?void 0:r.status,void R(a,c)},children:[null===(a=T.Task)||void 0===a||null===(c=a.resource)||void 0===c?void 0:c.status," ",Object(p.jsx)(j.c,{})]})}),Object(p.jsx)("td",{children:T.ServiceRequest.resource.orderDetail?T.ServiceRequest.resource.orderDetail[0].text:"Not Confirmed"}),Object(p.jsx)("td",{children:null===(s=T.Task)||void 0===s||null===(i=s.resource)||void 0===i||null===(o=i.owner)||void 0===o?void 0:o.display}),Object(p.jsx)("td",{children:Object(p.jsxs)("div",{role:"button",onClick:function(){return E(T)},children:[Object(p.jsx)("div",{className:"badge bg-primary",children:(null===(l=T.Communication)||void 0===l?void 0:l.length)||"0"})," ",Object(p.jsx)(w.a,{className:"text-primary "})]})}),Object(p.jsx)("td",{children:T.trackingItem?Object(p.jsx)("a",{href:"".concat(D.appUrl,"/dashboard/referrals/sent/all/").concat(T.trackingItem.core_referral_id),"data-bs-toggle":"tooltip",title:T.trackingItem.core_referral_id,"data-bs-placement":"top",target:"_blank",rel:"noreferrer noopener",children:"..."+T.trackingItem.core_referral_id.split("-").pop()}):null}),Object(p.jsx)("td",{children:z(T.ServiceRequest.resource.id)?"-":"+"})]}),Object(p.jsx)("tr",{className:z(T.ServiceRequest.resource.id)?"table-light":"collapse",id:"referral"+T.ServiceRequest.resource.id,children:Object(p.jsx)("td",{colSpan:"7",children:Object(p.jsx)("div",{className:"row px-3",children:Object(p.jsx)("table",{className:"table table-sm align-middle text-start",children:Object(p.jsxs)("tbody",{children:[T.trackingItem?Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(T.trackingItem)},children:["Task Tracking ",Object(p.jsx)(C.b,{})]})}),Object(p.jsxs)("td",{children:["Referral created in Unite Us"," ",Object(p.jsx)("a",{href:"".concat(D.appUrl,"/dashboard/referrals/sent/all/").concat(T.trackingItem.core_referral_id),"data-bs-toggle":"tooltip",title:T.trackingItem.core_referral_id,"data-bs-placement":"top",target:"_blank",rel:"noreferrer noopener",children:T.trackingItem.core_referral_id})]}),Object(p.jsx)("td",{children:Object(p.jsx)("button",{className:"btn btn-sm btn-danger",onClick:_,children:"Remove Referral Link"})})]}):null,Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(T.ServiceRequest.resource)},children:[T.ServiceRequest.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsxs)("td",{colSpan:"2",children:["Referral was authored on"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:T.ServiceRequest.resource.authoredOn})," ","by"," ",Object(p.jsxs)("div",{className:"btn btn-outline-primary",onClick:function(){return M(T.Practitioner.resource)},children:[T.ServiceRequest.resource.requester.display," ",Object(p.jsx)(C.b,{})]}),"."," ",T.ServiceRequest.resource.orderDetail?Object(p.jsxs)("span",{children:["Service type is ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:T.ServiceRequest.resource.orderDetail[0].text}),"."]}):"Service type has not been confirmed yet.",T.ServiceRequest.resource.supportingInfo?Object(p.jsxs)("span",{children:[" ","Attached is a supporting document of",Object(p.jsxs)("div",{className:"btn btn-outline-primary",onClick:function(){return M(T.DocumentReference[0])},children:[T.DocumentReference[0].type.text," ",Object(p.jsx)(C.b,{})]})]}):null]})]}),Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(T.Task.resource)},children:[T.Task.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsxs)("td",{children:[Object(p.jsxs)("span",{children:["Referral status is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(h=T.Task)||void 0===h||null===(f=h.resource)||void 0===f?void 0:f.status}),", last modified on"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(m=T.Task)||void 0===m||null===(v=m.resource)||void 0===v?void 0:v.lastModified})]})," ",Object(p.jsxs)("span",{children:["Recipient is"," ",Object(p.jsxs)("div",{className:"btn btn-outline-primary",onClick:function(){var e;return M(null===(e=T.Organization)||void 0===e?void 0:e.resource)},children:[null===(O=T.Task)||void 0===O||null===(x=O.resource)||void 0===x||null===(g=x.owner)||void 0===g?void 0:g.display," ",Object(p.jsx)(C.b,{})]})]})]}),Object(p.jsx)("td",{children:Object(p.jsx)("button",{className:"btn btn-sm btn-primary",onClick:function(){var e,t,n;return n=null===(e=T.Task)||void 0===e||null===(t=e.resource)||void 0===t?void 0:t.id,console.log("sending a task notification to Unite Us..."),void P(n,"Task")},children:"Send Task Notification"})})]}),T.Organization?Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(T.Organization.resource)},children:[T.Organization.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsxs)("td",{children:[Object(p.jsxs)("span",{children:["Recipient is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:T.Organization.resource.name})]}),B(T.Organization.resource)?Object(p.jsxs)("span",{children:["Their Unite Us UUID is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:B(T.Organization.resource).value})]}):null]}),Object(p.jsx)("td",{})]}):null,T.Patient?Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(T.Patient.resource)},children:[T.Patient.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsx)("td",{children:Object(p.jsxs)("div",{className:"btn btn-outline-primary disabled",children:[T.Patient.resource.name[0].family,","," ",T.Patient.resource.name[0].given[0]]})}),Object(p.jsx)("td",{})]}):null,T.Practitioner?Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(T.Practitioner.resource)},children:[T.Practitioner.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsx)("td",{children:Object(p.jsxs)("div",{className:"btn btn-outline-primary disabled",children:[T.Practitioner.resource.name[0].family,","," ",T.Practitioner.resource.name[0].given[0]]})}),Object(p.jsx)("td",{})]}):null,null===(N=T.Consent)||void 0===N?void 0:N.map((function(e,t){var n,r,a,c,s;return Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(e.resource)},children:[e.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsx)("td",{children:Object(p.jsxs)("span",{children:["Consent status is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:e.resource.status}),". Scope is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(n=e.resource.scope)||void 0===n?void 0:n.text}),". Provision period is from",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(r=e.resource.provision)||void 0===r||null===(a=r.period)||void 0===a?void 0:a.start}),"to",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(c=e.resource.provision)||void 0===c||null===(s=c.period)||void 0===s?void 0:s.end})]})}),Object(p.jsx)("td",{})]},t)})),null===(y=T.DocumentReference)||void 0===y?void 0:y.map((function(e,t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(e)},children:[e.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsx)("td",{children:Object(p.jsxs)("span",{children:["Document type is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:e.type.text}),". Document description is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:e.description})]})}),Object(p.jsx)("td",{})]},t)})),null===(k=T.Binary)||void 0===k?void 0:k.map((function(e,t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(e)},children:[e.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsxs)("td",{colSpan:"2",children:[Object(p.jsxs)("span",{children:["Content type is"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:e.contentType}),"."]})," ",Object(p.jsx)("div",{className:"btn btn-link",children:Object(p.jsxs)("a",{download:"Epic_CRN.pdf",href:"data:application/pdf;base64,".concat(e.data),title:"Download pdf document",children:["Click to download PDF file ",Object(p.jsx)(C.a,{})]})})]})]},t)})),null===(S=T.Communication)||void 0===S?void 0:S.map((function(e,t){var n,r,a,c;return Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{scoope:"row",children:Object(p.jsxs)("button",{type:"button",className:"btn btn-link",onClick:function(){return M(e.resource)},children:[e.resource.resourceType," ",Object(p.jsx)(C.b,{})]})}),Object(p.jsxs)("td",{children:[Object(p.jsxs)("span",{children:["On"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(n=e.resource)||void 0===n?void 0:n.sent}),", sent from"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(r=e.resource)||void 0===r?void 0:r.sender.display}),"to"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:null===(a=e.resource)||void 0===a?void 0:a.recipient[0].display}),"."]}),e.resource.payload?Object(p.jsxs)("div",{children:[" ","Note message:"," ",Object(p.jsx)("div",{className:"btn btn-outline-primary disabled",children:e.resource.payload[0].contentString})]}):Object(p.jsx)("span",{children:" Note message is empty."}),e.resource.payload&&(null===(c=e.resource.payload[1])||void 0===c?void 0:c.contentReference)?Object(p.jsxs)("div",{children:[" ","A"," ",Object(p.jsxs)("div",{className:"btn btn-outline-primary",onClick:function(){return M(T.DocumentReference[0])},children:["document ",Object(p.jsx)(C.b,{})]})," ","was attached to the communication."]}):null]}),Object(p.jsx)("td",{children:e.resource.sender.reference.includes("Practitioner/")?e.received?Object(p.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:function(){return J(e.resource.id)},children:[" ","Send Communication Notification"]}):Object(p.jsxs)("div",{children:[Object(p.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:function(){return J(e.resource.id)},children:[" ","Send Communication Notification"]}),Object(p.jsx)("button",{className:"btn btn-sm btn-danger",onClick:function(){return H(e)},children:"Remove Communication Link"})]}):Object(p.jsx)("button",{className:"btn btn-sm btn-warning",onClick:function(){return E(T)},children:"Add a new note"})})]},t)}))]})})})})})]})},I=n(45),R=n(46),E=n(13),U=function(e){var t=e.showReferralStatus,n=e.currentReferralStatus,a=e.closeReferralStatusEdit,c=(e.profileName,Object(r.useState)("")),s=Object(b.a)(c,2),i=s[0],o=s[1],l=Object(r.useState)({value:"Please select a reason ..."}),d=Object(b.a)(l,2),u=d[0],h=d[1],f=Object(r.useState)(""),m=Object(b.a)(f,2),v=m[0],O=m[1],x=Object(r.useState)(!1),g=Object(b.a)(x,2),N=g[0],y=g[1],k=function(){o(""),h({value:"Please select a reason ..."}),O(""),a(null)},S=function(e){console.log("new status is: ",e),o(e)},C=function(e){if(!N)return!0;switch(e){case"requested":return"requested"===n||"accepted"===n||"rejected"===n||""===n;case"accepted":case"rejected":return"requested"===n||"accepted"===n||"rejected"===n||""===n;case"completed":case"failed":return"in-progress"===n;default:return!1}},w=function(e){switch(e){case"accepted":return"primary";case"in-progress":return"info";case"rejected":case"failed":return"danger";case"completed":return"success";case"cancelled":return"danger";case"requested":return"secondary";default:return"dark"}},T=function(e){var t=w(i||n),r=1;switch(i||n){case"requested":r=1;break;case"accepted":r=2;break;case"in-progress":r=3;break;case"completed":r=4;break;default:r=5}return r<e?"table-secondary":"table-"+t};return Object(p.jsxs)(I.a,{id:"referralStatus",size:"lg",show:t,onHide:k,children:[Object(p.jsx)(I.a.Header,{className:"bg-light",closeButton:!0,children:Object(p.jsx)(I.a.Title,{children:"Update Referral Status"})}),Object(p.jsxs)(I.a.Body,{children:[Object(p.jsxs)("div",{className:"row my-3 text-center",children:[Object(p.jsxs)("div",{className:"col-6",children:["Current Stauts: ",Object(p.jsx)("div",{className:"btn btn-outline-"+w(n),children:n})]}),Object(p.jsxs)("div",{className:"col-6",children:["New Status    : ",Object(p.jsx)("div",{className:"btn active btn-outline-"+w(i||n),children:i||n})]})]}),Object(p.jsx)("div",{className:"btn-group mb-2 text-center container-fluid",role:"group","aria-label":"Referral status selector",id:"statusGroup",children:Object(p.jsxs)("table",{className:"table table-bordered table-sm",children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsxs)("th",{className:T(1),children:["INITIATE"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.a,{})})]}),Object(p.jsxs)("th",{className:T(2),children:["RESPONSE"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.a,{})})]}),Object(p.jsxs)("th",{className:T(3),children:["CONFIRM"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.a,{})})]}),Object(p.jsxs)("th",{className:T(4),children:["RESOLVE"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.e,{})})]})]})}),Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{rowSpan:"3",className:"table-light",children:Object(p.jsxs)("div",{className:"d-grid gap-2",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStatus",id:"statusRequested",autoComplete:"off",value:"requested",defaultChecked:"requested"===n,onClick:function(e){S(e.target.value)},disabled:!C("requested")}),Object(p.jsxs)("label",{class:"btn btn-outline-secondary",htmlFor:"statusRequested",children:[Object(p.jsx)(E.a,{className:C("requested")?"invisible":"visible"})," ","requested ",Object(p.jsx)(E.a,{className:"invisible"})]})]})}),Object(p.jsx)("td",{colSpan:"3",className:"table-light",children:Object(p.jsxs)("div",{className:"d-grid gap-2",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check btn-block",name:"btnStatus",id:"statusCancelled",autoComplete:"off",value:"cancelled",defaultChecked:"cancelled"===n,onClick:function(e){S(e.target.value)},disabled:!C("cancelled")}),Object(p.jsxs)("label",{class:"btn btn-outline-danger",htmlFor:"statusCancelled",children:[Object(p.jsx)(E.a,{className:C("cancelled")?"invisible":"visible"})," ","cancelled"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.e,{})})]})]})})]}),Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:Object(p.jsxs)("div",{className:"d-grid gap-2",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStatus",id:"statusAccepted",autoComplete:"off",value:"accepted",defaultChecked:"accepted"===n,onClick:function(e){S(e.target.value)},disabled:!C("accepted")}),Object(p.jsxs)("label",{class:"btn btn-outline-primary",htmlFor:"statusAccepted",children:[Object(p.jsx)(E.a,{className:C("accepted")?"invisible":"visible"})," ","accepted ",Object(p.jsx)(E.a,{className:"invisible"})]})]})}),Object(p.jsx)("td",{className:"table-light",children:Object(p.jsxs)("div",{className:"d-grid gap-2",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStatus",id:"statusInProgress",autoComplete:"off",value:"in-progress",defaultChecked:"in-progress"===n,onClick:function(e){S(e.target.value)},disabled:!C("in-progress")}),Object(p.jsxs)("label",{class:"btn btn-outline-info",htmlFor:"statusInProgress",children:[Object(p.jsx)(E.a,{className:C("in-progress")?"invisible":"visible"})," ","in-progress ",Object(p.jsx)(E.a,{className:"invisible"})]})]})}),Object(p.jsx)("td",{children:Object(p.jsxs)("div",{className:"d-grid gap-2",children:[Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStatus",id:"statusCompleted",autoComplete:"off",value:"completed",defaultChecked:"completed"===n,onClick:function(e){S(e.target.value)},disabled:!C("completed")}),Object(p.jsxs)("label",{class:"btn btn-outline-success",htmlFor:"statusCompleted",children:[Object(p.jsx)(E.a,{className:C("completed")?"invisible":"visible"})," ","completed"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.e,{})})]}),Object(p.jsx)("input",{type:"radio",className:"btn-check",name:"btnStatus",id:"statusFailed",autoComplete:"off",value:"failed",defaultChecked:"failed"===n,onClick:function(e){S(e.target.value)},disabled:!C("failed")}),Object(p.jsxs)("label",{class:"btn btn-outline-danger",htmlFor:"statusFailed",children:[Object(p.jsx)(E.a,{className:C("failed")?"invisible":"visible"})," ","failed"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.e,{})})]})]})})]}),Object(p.jsx)("tr",{children:Object(p.jsx)("td",{colSpan:"3",children:Object(p.jsxs)("div",{className:"d-grid gap-2",children:[Object(p.jsx)("input",{type:"radio",className:"btn btn-sm btn-check",name:"btnStatus",id:"statusRejected",autoComplete:"off",value:"rejected",onClick:function(e){S(e.target.value)},defaultChecked:"rejected"===n,disabled:!C("rejected")}),Object(p.jsxs)("label",{class:"btn btn-outline-danger",htmlFor:"statusRejected",children:[Object(p.jsx)(E.a,{className:C("rejected")?"invisible":"visible"})," ","rejected"," ",Object(p.jsx)("span",{className:"float-end",children:Object(p.jsx)(j.e,{})})]}),Object(p.jsxs)("div",{className:"rejected"===i?"":"d-none",children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"REJECT REASON"}),Object(p.jsx)("div",{children:Object(p.jsxs)("select",{className:"form-select",value:u.value,onChange:function(e){return h({value:e.target.value,text:e.target.options[e.target.selectedIndex].text})},children:[Object(p.jsx)("option",{children:"Select a reason ..."}),[{display_name:"Not Eligible",value:"Client is not eligible for our services"},{display_name:"Duplicate",value:"Duplicate, case already exists in the system"},{display_name:"No Capacity",value:"We do not have capacity to serve client"},{display_name:"Do Not Provide Service",value:"We do not provide the services requested/needed"},{display_name:"Unable to Contact Client",value:"We were unable to contact the client"},{display_name:"Other",value:"Other"}].map((function(e){return Object(p.jsx)("option",{value:e.value,children:e.display_name})}))]})})]}),Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{className:"col-form-label",children:"NOTE"}),Object(p.jsx)("div",{children:Object(p.jsx)("textarea",{className:"form-control",rows:"3",cols:"50",placeholder:"Enter a note for the reject reason",value:v,onChange:function(e){return O(e.target.value)}})})]})]})]})})})]})]})})]}),Object(p.jsxs)(I.a.Footer,{children:[Object(p.jsxs)("div",{className:"col form-check form-switch mx-2 float-start text-start",children:[Object(p.jsx)("input",{className:"form-check-input",type:"checkbox",role:"button",id:"flexSwitchBusinessRule",checked:N,onChange:function(){return y(!N)}}),Object(p.jsx)("label",{className:"form-check-label",role:"button",htmlFor:"flexSwitchBusinessRule",children:"Enforce Epic Business Rules"})]}),Object(p.jsx)(R.a,{className:"col",variant:"warning",onClick:k,children:"Cancel"}),Object(p.jsx)(R.a,{className:"col",variant:"primary",onClick:function(){o(i),a({value:i,rejectReason:{reason:u,note:v}})},children:"Submit"})]})]})},P=n(28),D=n(27),A=function(e){var t=e.showAddNote,n=e.referral,a=e.closeAddNote,c=e.baseUrl,s=e.currentStageBaseUrl,i=Object(r.useState)(""),o=Object(b.a)(i,2),l=o[0],j=o[1],h=Object(r.useState)(""),f=Object(b.a)(h,2),m=f[0],v=f[1],O=Object(r.useState)(0),x=Object(b.a)(O,2),g=x[0],N=x[1],y=Object(r.useState)(!1),k=Object(b.a)(y,2),S=k[0],C=k[1],w=Object(r.useState)([]),T=Object(b.a)(w,2),E=T[0],U=T[1],A=Object(r.useState)("Sending communication note ..."),F=Object(b.a)(A,2),L=F[0],q=F[1];Object(r.useEffect)((function(){U(null===n||void 0===n?void 0:n.Communication),console.log("useEffect cl:",E)}),[n]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(d.a.mark((function e(){var t,r,a,i,o,l,u,b,j;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q("Retriving communcation notes ..."),C(!0),a="".concat(s,"/mockapi/request/search"),e.next=5,fetch(a,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":"sfsdfddfdsfsdfs32342343"},body:JSON.stringify({baseUrl:c,resourceType:"Communication",queryParams:{"part-of":null===n||void 0===n?void 0:n.Task.resource.id}})});case 5:return i=e.sent,e.next=8,i.json();case 8:o=e.sent,(null===(t=o.response)||void 0===t||null===(r=t.body)||void 0===r?void 0:r.total)>0&&(U(null===(l=o.response)||void 0===l||null===(u=l.body)||void 0===u?void 0:u.entry),n.Communication=null===(b=o.response)||void 0===b||null===(j=b.body)||void 0===j?void 0:j.entry),C(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(null===n||void 0===n?void 0:n.Task)&&e(),j("")}),[g]);var M=function(){var e=Object(u.a)(d.a.mark((function e(){var t,r,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q("Sending communication note ..."),C(!0),r="".concat(s,"/mockapi/communication_out/process"),e.next=5,fetch(r,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":"sfsdfddfdsfsdfs32342343"},body:JSON.stringify({note:l,referralId:null===n||void 0===n||null===(t=n.trackingItem)||void 0===t?void 0:t.core_referral_id,sentAt:Math.floor(Date.now()/1e3)})});case 5:return a=e.sent,e.next=8,a.json();case 8:return c=e.sent,v(JSON.stringify(c)),N(g+1),C(!1),e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(e){var t,n,r,a,c;return e?{name:null===(t=e.resource)||void 0===t||null===(n=t.sender)||void 0===n?void 0:n.display,type:"Organization"===(null===(r=e.resource)||void 0===r||null===(a=r.sender)||void 0===a||null===(c=a.reference)||void 0===c?void 0:c.split("/")[0])?"cbo":"ehr"}:null},z=function(e){var t;return"ehr"===(null===(t=B(e))||void 0===t?void 0:t.type)?"seashell":"aliceblue"},_=function(e){var t;return"ehr"===(null===(t=B(e))||void 0===t?void 0:t.type)?"start":"end"},H=function(e){var t,n=null===(t=e.resource)||void 0===t?void 0:t.recipient,r="Replied to: ";return n.forEach((function(e){r+=e.display+", "})),r},J=function(){v(""),a()};return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(I.a,{id:"addNote",size:"lg",show:t,onHide:J,children:[Object(p.jsx)(I.a.Header,{className:"bg-light",closeButton:!0,children:Object(p.jsx)(I.a.Title,{children:"Referral Communications"})}),Object(p.jsxs)(I.a.Body,{children:[Object(p.jsx)("table",{className:"table table-responsive table-hover",children:Object(p.jsx)("tbody",{children:null===E||void 0===E?void 0:E.map((function(e,t){var n,r,a,c,s,i,o;return Object(p.jsx)("tr",{children:Object(p.jsx)("td",{className:"p-0",children:Object(p.jsx)("table",{className:"table table-borderless m-0 p-0",children:Object(p.jsxs)("tbody",{children:[Object(p.jsx)("tr",{children:Object(p.jsx)("td",{className:"text-center text-secondary",children:null===(n=e.resource)||void 0===n?void 0:n.sent})}),"cbo"===B(e).type?Object(p.jsxs)("tr",{className:"text-".concat(_(e)," text-secondary"),children:[Object(p.jsx)("td",{className:"py-0",children:H(e)})," "]}):Object(p.jsx)("tr",{className:"text-".concat(_(e)," text-secondary"),children:Object(p.jsxs)("td",{className:"py-0",children:["From: ",B(e).name]})}),Object(p.jsx)("tr",{className:"text-".concat(_(e)),children:Object(p.jsxs)("td",{style:{backgroundColor:z(e)},children:[Object(p.jsx)("div",{className:"btn mt-0 mx-0 text-start disabled text-body",style:{opacity:1},children:(null===(r=e.resource)||void 0===r?void 0:r.payload)?null===(a=e.resource)||void 0===a||null===(c=a.payload[0])||void 0===c?void 0:c.contentString:"[empty]"}),(null===(s=e.resource)||void 0===s?void 0:s.payload)&&(null===(i=e.resource)||void 0===i||null===(o=i.payload[1])||void 0===o?void 0:o.contentReference)?Object(p.jsxs)("p",{children:[Object(p.jsx)(D.a,{}),"Document attachment"]}):null]})})]})})})})}))})}),(null===n||void 0===n?void 0:n.trackingItem)?Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsxs)("div",{className:"d-flex",children:[Object(p.jsx)("label",{className:"col-form-label col-6 vertical-bottom",children:"NEW NOTE"}),Object(p.jsx)("div",{className:"btn btn-primary col-6",onClick:M,children:"Send"})]}),Object(p.jsxs)("div",{className:S?"toast bg-warning text-secondary show":"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",id:"messageToastModal",children:[Object(p.jsx)("div",{className:"toast-header",children:Object(p.jsx)("strong",{className:"me-auto",children:"Please Wait ..."})}),Object(p.jsxs)("div",{className:"toast-body",children:[L," ",Object(p.jsx)("div",{className:"spinner-border text-warning",role:"status",children:Object(p.jsx)("span",{className:"visually-hidden",children:"..."})})]})]}),Object(p.jsx)("div",{children:Object(p.jsx)("textarea",{className:"form-control",rows:"3",cols:"50",placeholder:"Enter a new note",value:l,onChange:function(e){return j(e.target.value)}})}),""===m?null:Object(p.jsxs)("div",{className:"row",children:[Object(p.jsxs)("div",{className:"col-10",children:[Object(p.jsx)("pre",{children:m})," "]}),Object(p.jsx)("div",{className:"col-2",children:Object(p.jsx)(P.a,{calssName:"col-2",onClick:function(){v("")}})})]})]}):null]}),Object(p.jsx)(I.a.Footer,{children:Object(p.jsx)(R.a,{className:"col",variant:"warning",onClick:J,children:"Close"})})]})})};var F=function(e){var t=e.onCreate,n=e.referralList,a=e.currentEncounter,c=e.sendNotificationUU,s=e.profileName,i=e.updateReferralStatus,o=e.baseUrl,l=e.sendUUNotification,d=e.currentStage,u=Object(r.useState)(!1),j=Object(b.a)(u,2),h=j[0],f=j[1],m=Object(r.useState)(!1),v=Object(b.a)(m,2),O=v[0],x=v[1],g=Object(r.useState)(!1),N=Object(b.a)(g,2),k=N[0],C=N[1],w=Object(r.useState)(),E=Object(b.a)(w,2),P=E[0],D=E[1],F=Object(r.useState)(""),L=Object(b.a)(F,2),q=L[0],M=L[1],B=Object(r.useState)(),z=Object(b.a)(B,2),_=z[0],H=z[1],J=Object(r.useState)(!1),G=Object(b.a)(J,2),W=G[0],Y=G[1],Z=Object(r.useState)(),V=Object(b.a)(Z,2),K=V[0],X=V[1],Q=function(){f((function(e){return!e}))},$=function(e,t){D(e),x(t)},ee=function(){return x(!1)},te=function(e,t){C(!0),H(e),M(t)},ne=function(e){X(e),Y(!0)};return Object(p.jsxs)("div",{className:"col-md-9 col-lg-10 px-0",children:[Object(p.jsx)("div",{className:"referrals",children:Object(p.jsxs)("div",{className:"referralList",children:[Object(p.jsx)(y,{toggleShowNewReferral:Q,showNewReferral:h,currentEncounter:a,sendNotificationUU:c,profileName:s}),h?Object(p.jsx)(S,{onCreate:function(e){t(e),Q()},toggleShowNewReferral:Q}):null,(null===n||void 0===n?void 0:n.length)>0?Object(p.jsx)("div",{className:"table-responsive",children:Object(p.jsxs)("table",{className:"table table-hover",children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"DATE SENT"}),Object(p.jsx)("th",{children:"STATUS"}),Object(p.jsx)("th",{children:"SERVICE TYPE"}),Object(p.jsx)("th",{children:"RECEIPIENT"}),Object(p.jsx)("th",{children:"NOTES"}),Object(p.jsx)("th",{children:"UU REFERRAL"}),Object(p.jsx)("th",{children:"+/-"})]})}),Object(p.jsx)("tbody",{children:n.map((function(e,t){return Object(p.jsx)(T,{referral:e,showFhirSource:$,editReferralStatus:te,showAddNoteWindow:ne,baseUrl:o,sendUUNotification:l,currentStage:d},t)}))})]})}):null]})}),Object(p.jsxs)(I.a,{id:"fhirSource",size:"lg",show:O,onHide:ee,children:[Object(p.jsx)(I.a.Header,{className:"bg-light",closeButton:!0,children:Object(p.jsxs)(I.a.Title,{children:[null===P||void 0===P?void 0:P.resourceType," : ",null===P||void 0===P?void 0:P.id]})}),Object(p.jsx)(I.a.Body,{children:Object(p.jsx)("pre",{id:"json",children:JSON.stringify(P,void 0,2)})}),Object(p.jsx)(I.a.Footer,{children:Object(p.jsx)(R.a,{variant:"warning",onClick:ee,children:"Close"})})]}),Object(p.jsx)(U,{showReferralStatus:k,currentReferralStatus:q,closeReferralStatusEdit:function(e){C(!1),null!==e&&(console.log("new status: ",e.value,e.rejectReason),i(_,e))},profileName:s}),Object(p.jsx)(A,{showAddNote:W,referral:K,communicationList:null===K||void 0===K?void 0:K.Communication,closeAddNote:function(){Y(!1)},baseUrl:o,currentStageBaseUrl:d.baseUrl})]})},L={name:"Epic",defaultPatient:{firstName:"Calvin",lastName:"Ccm",gender:"Male",dob:"01/01/1990",mrn:"203724",fhirId:"e4ikKcC2Rp3EsZQh8Ac6C5A3",uuid:"b5318891-3dc8-426a-af50-531e106ad1a1"},defaultProvider:{firstName:"Case",lastName:"Manager",fhirId:"eaToFIkaJ32mO4K002q3BLw3",uuid:"94e5f7ee-1425-42bc-8833-3474b687b125",groupId:"bf4aa373-81eb-4da5-9980-2d3e51c57b3c",networkId:"145ca925-ba86-490d-b404-35f4fe5ada66"},defaultEncounter:"eEDcHpsgsD0Pv4Ih8HnfOxA3",defaultDocumentReference:"e1.cnazaNgltIElLYGLL4Sg3",defaultBaseUrl:"https://apporchard.epic.com/interconnect-aocurprd-oauth/api/FHIR/R4",defaultNotificationUrl:"https://fhir-crn.uniteustraining.com/poc/FhirNotificationWebService",accessToken:"e2a4575581b3f57203e182b0b1f3dcea479baecd31bef125cc57f6dd4b8905ac"},q={name:"Epic2",defaultPatient:{firstName:"Beverly",lastName:"Ccm",gender:"Female",dob:"01/01/1940",mrn:"203722",fhirId:"egHmZUd91rLItB1AqGV49Pg3",uuid:"b5318891-3dc8-426a-af50-531e106ad1a1"},defaultProvider:{firstName:"Case",lastName:"Manager",fhirId:"eaToFIkaJ32mO4K002q3BLw3",uuid:"94e5f7ee-1425-42bc-8833-3474b687b125",groupId:"bf4aa373-81eb-4da5-9980-2d3e51c57b3c",networkId:"145ca925-ba86-490d-b404-35f4fe5ada66"},defaultEncounter:"eFBT3k94CLm3fCPMNlKH2DQ3",defaultDocumentReference:"e.-1q0eXQDEZ.9mNdXwVjYA3",defaultBaseUrl:"https://apporchard.epic.com/interconnect-aocurprd-oauth/api/FHIR/R4",defaultNotificationUrl:"https://fhir-crn.uniteustraining.com/poc/FhirNotificationWebService",accessToken:"e2a4575581b3f57203e182b0b1f3dcea479baecd31bef125cc57f6dd4b8905ac"},M={name:"Logica",defaultPatient:{firstName:"Beverly",lastName:"Ccm",gender:"Female",dob:"01/01/1940",mrn:"203722",fhirId:"14730",uuid:"b5318891-3dc8-426a-af50-531e106ad1a1"},defaultProvider:{firstName:"Demo",lastName:"Provider",fhirId:"14734",uuid:"94e5f7ee-1425-42bc-8833-3474b687b125",groupId:"bf4aa373-81eb-4da5-9980-2d3e51c57b3c",networkId:"145ca925-ba86-490d-b404-35f4fe5ada66"},defaultEncounter:"14801",defaultDocumentReference:"14740",defaultBaseUrl:"https://api.logicahealth.org/uufhircrn/open",defaultNotificationUrl:"https://fhir-crn.uniteustraining.com/poc/FhirNotificationWebService",accessToken:""},B={name:"staging",baseUrl:"https://fhir-crn.uniteusdev.com/v1",appUrl:"https://app.uniteusdev.com",token:"wOvYlZbrIW6THlB68QcJk6UlCwNPKYHfibNCMj03",provider:{firstName:"Five",lastName:"Auto",email:"five@auto.com",user_id:"184bd75d-e4da-4751-899c-b3a9da0599ba",group_id:"c31a43c0-c593-4c96-84ed-6f966e895649",network_id:"c88b9628-b76c-434b-ad58-62bb2ca9d6c0",access_token_legacy:"b6063af252fb95dea2a0e0a5e049035ddad33a14192f19804662b9f9896b6bd0",access_token_core:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImZoaXJjcm5yZXF1ZXN0cyJ9.eyJpc3MiOm51bGwsInN1YiI6Ijk2NDA4MjA5LTA2YzktNGVjYi05ZjBkLWYyZjAxNTc4Y2QyZiIsImVtYWlsIjoiZmhpci5jcm4ucmVxdWVzdHNAdW5pdGV1cy5jb20iLCJhdWQiOltdLCJleHAiOjIxNDc0ODM2NDcsIm5iZiI6MTYyNjcxODMxOSwiaWF0IjoxNjI2NzE4MzE5LCJqdGkiOiIzY2U1MjE0ODhmM2RjZTgzZjVkNmM2MzgwYWFjMzYzZGU2MjI1ZTNlODU1ZGVmOWFiOSIsInVzZXJfaW50ZXJjb21faG1hYyI6ImEwYmY1NGI1OGUzYzg0MDI2MWUxMWMwZWI5Y2EyMGM2NDYzMTMwOWUzZjYxMWZhZjlhOTQwZjQyNDBlOTk4YzgifQ.JU3X_WOYWZlLr2dYSKf135LyvkDzjDqhtUbJYlZd0NM"}.freeze},z={name:"training",baseUrl:"https://fhir-crn.uniteustraining.com/v1",appUrl:"https://app.uniteustraining.com",token:"qgx2q5m35Q42q83kkM5FX67S0KHyFsCf4HVb5hpI",provider:{firstName:"Case",lastName:"Manager",fhirId:"eaToFIkaJ32mO4K002q3BLw3",uuid:"94e5f7ee-1425-42bc-8833-3474b687b125",groupId:"bf4aa373-81eb-4da5-9980-2d3e51c57b3c",networkId:"145ca925-ba86-490d-b404-35f4fe5ada66"}},_={name:"poc",baseUrl:"https://fhir-crn.uniteustraining.com/poc",appUrl:"https://devqa.uniteusdev.com/core-phase-3",appUrl2:"https://devqa.uniteusdev.com/core-phase-3",token:"USZEkhXmZO8vDzg2aArT16bsPregoov66fetdapY",provider:{firstName:"Case",lastName:"Manager",fhirId:"eaToFIkaJ32mO4K002q3BLw3",uuid:"94e5f7ee-1425-42bc-8833-3474b687b125",groupId:"bf4aa373-81eb-4da5-9980-2d3e51c57b3c",networkId:"145ca925-ba86-490d-b404-35f4fe5ada66"}};var H=function(){var e=M,t=e.name,n=Object(r.useState)(t),a=Object(b.a)(n,2),c=a[0],s=a[1],l=Object(r.useState)(e.defaultPatient),j=Object(b.a)(l,2),h=j[0],f=j[1],m=Object(r.useState)(e.defaultProvider),v=Object(b.a)(m,2),O=v[0],g=v[1],y=Object(r.useState)(e.defaultEncounter),k=Object(b.a)(y,2),S=k[0],C=k[1],w=Object(r.useState)(e.access_token),T=Object(b.a)(w,2),I=T[0],R=T[1],E=Object(r.useState)(e.defaultBaseUrl),U=Object(b.a)(E,2),P=U[0],D=U[1],A=Object(r.useState)([]),H=Object(b.a)(A,2),J=H[0],G=H[1],W=Object(r.useState)([]),Y=Object(b.a)(W,2),Z=Y[0],V=Y[1],K=Object(r.useState)(""),X=Object(b.a)(K,2),Q=X[0],$=X[1],ee="Retrieving FHIR resources ... ",te=Object(r.useState)(ee),ne=Object(b.a)(te,2),re=ne[0],ae=ne[1],ce=Object(r.useState)(!0),se=Object(b.a)(ce,2),ie=se[0],oe=se[1],le=z,de=Object(r.useState)(le),ue=Object(b.a)(de,2),be=ue[0],je=ue[1],pe=Object(r.useState)(le.baseUrl),he=Object(b.a)(pe,2),fe=he[0],me=he[1],ve=Object(r.useState)("0%"),Oe=Object(b.a)(ve,2),xe=Oe[0],ge=Oe[1],Ne=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,c,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={name:"Logica2",defaultPatient:{fhirId:t,uuid:""},defaultProvider:{firstName:"Demo",lastName:"Provider",fhirId:"14734",uuid:"94e5f7ee-1425-42bc-8833-3474b687b125",groupId:"bf4aa373-81eb-4da5-9980-2d3e51c57b3c",networkId:"145ca925-ba86-490d-b404-35f4fe5ada66"},defaultEncounter:"14801",defaultDocumentReference:"14740",defaultBaseUrl:"https://api.logicahealth.org/uufhircrn/open"},c=P+"/Patient/"+t,e.next=4,fetch(c,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json"}});case 4:if(200===(s=e.sent).status){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,s.json();case 9:return i=e.sent,console.log("Patient received: ",i),a.defaultPatient.firstName=null===(n=i.name[0])||void 0===n?void 0:n.given[0],a.defaultPatient.lastName=null===(r=i.name[0])||void 0===r?void 0:r.family,a.defaultPatient.gender=i.gender,a.defaultPatient.dob=i.birthDate,e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,c=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c.length>1&&void 0!==c[1]?c[1]:"",ge("0%"),ae(ee),oe(!0),console.log("Switch to profile: ",t,n),s(t),e.t0=t,e.next="Logica"===e.t0?9:"Logica2"===e.t0?12:"Epic2"===e.t0?24:27;break;case 9:return r=M,"poc"===be.name&&(be.appUrl=B.appUrl),e.abrupt("break",29);case 12:if(""!==n){e.next=15;break}return oe(!1),e.abrupt("return");case 15:return e.next=17,Ne(n);case 17:if(null!==(r=e.sent)){e.next=22;break}return ae("Invalid patient FHIR ID"),ge("error"),e.abrupt("return");case 22:return"poc"===be.name&&(be.appUrl=_.appUrl2),e.abrupt("break",29);case 24:return r=q,"poc"===be.name&&(be.appUrl=_.appUrl2),e.abrupt("break",29);case 27:r=L,"poc"===be.name&&(be.appUrl=_.appUrl2);case 29:if(f(r.defaultPatient),g(r.defaultProvider),D(r.defaultBaseUrl),"Logica"!==r.name&&"Logica2"!==r.name){e.next=36;break}R(n),e.next=40;break;case 36:return e.next=38,Be();case 38:a=e.sent,R(a);case 40:oe(!1),ge("0%");case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=Object(u.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=be,e.t0=t,e.next="training"===e.t0?4:"staging"===e.t0?6:"poc"===e.t0?8:11;break;case 4:return n=z,e.abrupt("break",12);case 6:return n=B,e.abrupt("break",12);case 8:return(n=_).appUrl="Logica"===c?B.appUrl:_.appUrl2,e.abrupt("break",12);case 11:n=le;case 12:return console.log("Switch to stage: ",n),je(n),me(n.baseUrl),e.next=17,Ae(S,P);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le(h.fhirId,P);case 2:if(!((null===(t=e.sent)||void 0===t?void 0:t.length)>0)){e.next=6;break}return e.next=6,Ae(t[0].resource.id,P);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,c,s,i,l,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge("0%"),ae("Sending create requests ... "),oe(!0),console.log("create referral: ",t),n=(new Date).toISOString(),r=P+"/ServiceRequest",a={resourceType:"ServiceRequest",status:"active",intent:"plan",category:[{coding:[{system:"http://snomed.info/sct",code:"307835004",display:"Referral by service"}],text:"Referral by service"}],priority:"routine",subject:{reference:"Patient/".concat(h.fhirId),display:h.lastName+", "+h.firstName},encounter:{reference:"Encounter/".concat(S)},authoredOn:n,requester:[{reference:"Practitioner/".concat(O.fhirId),display:O.firstName+" "+O.lastName}]},t.attachDocument&&Q.length>0&&(a.supportingInfo=[{reference:"DocumentReference/".concat(Q)}]),e.next=10,fetch(r,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)});case 10:return c=e.sent,e.next=13,c.json();case 13:return s=e.sent,i=s.id,console.log("server request id: ",i),r=P+"/Task",a={resourceType:"Task",basedOn:[{reference:"ServiceRequest/".concat(i)}],status:"requested",intent:"plan",priority:"routine",for:{reference:"Patient/".concat(h.fhirId),display:h.lastName+", "+h.firstName},encounter:{reference:"Encounter/".concat(S)},authoredOn:n,lastModified:n,requester:[{reference:"Practitioner/".concat(O.fhirId),display:O.firstName+" "+O.lastName}],owner:{reference:"Organization/".concat(t.referredToGroupIds.value),display:t.referredToGroupIds.text}},ge("5%"),e.next=21,fetch(r,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)});case 21:return c=e.sent,e.next=24,c.json();case 24:return s=e.sent,l=s.id,console.log("Task id: ",l),r=P+"/Communication",(a={resourceType:"Communication",basedOn:[{reference:"ServiceRequest/".concat(i)}],partOf:[{reference:"Task/".concat(l)}],status:"in-progress",subject:{reference:"Patient/".concat(h.fhirId),display:h.lastName+", "+h.firstName},encounter:{reference:"Encounter/".concat(S)},sent:n,recipient:[{reference:"Organization/".concat(t.referredToGroupIds.value),display:t.referredToGroupIds.text}],sender:{reference:"Practitioner/".concat(O.fhirId),display:O.firstName+" "+O.lastName}}).payload=[],t.description.length>0&&(a.payload=[{contentString:t.description}]),t.attachDocument&&Q.length>0&&(a.payload=[].concat(Object(o.a)(a.payload),[{contentReference:{reference:"DocumentReference/".concat(Q)}}])),e.next=34,fetch(r,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)});case 34:return c=e.sent,e.next=37,c.json();case 37:return s=e.sent,u=s.id,console.log("Communication id: ",u),e.next=42,Fe();case 42:ge("100%"),oe(!1);case 44:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a,s,o,l,u,b,j,p,h,f,m,v,O,x,g,N,y,k,C,w,T,R,E,U,D,A,F,L,q,M,B,z,_=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.length>0&&void 0!==_[0]?_[0]:S,n=_.length>1&&void 0!==_[1]?_[1]:P,ae(ee),ge("10%"),r=n+"/Task?encounter="+t+"&_include=Task%3Apatient&_include=Task%3Aencounter&_include=Task%3Arequester&_include=Task%3Abased-on&_include=Task%3Aowner%3AOrganization",e.next=7,fetch(r,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json",Authorization:(null===I||void 0===I?void 0:I.length)>0&&"Logica"!==c.substring(0,6)?"bearer "+I:""}});case 7:return a=e.sent,e.next=10,a.json();case 10:if(s=e.sent,o=0===s.total?[]:s.entry){e.next=14;break}return e.abrupt("return",[]);case 14:console.log("Task bundle received: ",o),l=[],o.forEach((function(e,t){if("Task"===e.resource.resourceType){var n={id:"Task/"+e.resource.id,Task:e};l.push(n)}})),l.forEach((function(e,t){var n,r,a,c,s=null===e||void 0===e||null===(n=e.Task)||void 0===n?void 0:n.resource;if(s){var i=null===(r=s.for)||void 0===r?void 0:r.reference,l=s.basedOn[0].reference,d=null===(a=s.requester)||void 0===a?void 0:a.reference,u=null===(c=s.owner)||void 0===c?void 0:c.reference;o.forEach((function(t,n){var r=t.resource.id;switch(t.resource.resourceType){case"ServiceRequest":l==="ServiceRequest/".concat(r)&&(e.ServiceRequest=t);break;case"Patient":i==="Patient/".concat(r)&&(e.Patient=t);break;case"Organization":u==="Organization/".concat(r)&&(e.Organization=t);break;case"Practitioner":d==="Practitioner/".concat(r)&&(e.Practitioner=t)}}))}})),ge("40%"),u=0,b=l;case 20:if(!(u<b.length)){e.next=50;break}return h=b[u],f=null===h||void 0===h||null===(j=h.Task)||void 0===j||null===(p=j.resource)||void 0===p?void 0:p.id,e.next=25,Ie(f);case 25:if(m=e.sent,h.Communication=m.entry,null!=h.Communication){e.next=29;break}return e.abrupt("continue",47);case 29:v=Object(i.a)(h.Communication),e.prev=30,v.s();case 32:if((O=v.n()).done){e.next=39;break}return x=O.value,e.next=36,Re(x.resource.id);case 36:x.received=e.sent;case 37:e.next=32;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(30),v.e(e.t0);case 44:return e.prev=44,v.f(),e.finish(44);case 47:u++,e.next=20;break;case 50:ge("70%"),g=0,N=l;case 52:if(!(g<N.length)){e.next=61;break}return y=N[g],e.next=56,Ee(y);case 56:(null===(k=e.sent)||void 0===k?void 0:k.length)>0&&(y.DocumentReference=k,$(y.DocumentReference[0].id),console.log("documentReference",y.DocumentReference),console.log("sampleDocumentReference",Q));case 58:g++,e.next=52;break;case 61:ge("85%"),C=0,w=l;case 63:if(!(C<w.length)){e.next=73;break}if(R=w[C],!((null===(T=R.DocumentReference)||void 0===T?void 0:T.length)>0)){e.next=70;break}return e.next=68,Ue(R.DocumentReference);case 68:(null===(E=e.sent)||void 0===E?void 0:E.length)>0&&(R.Binary=E);case 70:C++,e.next=63;break;case 73:ge("95%"),U=0,D=l;case 75:if(!(U<D.length)){e.next=85;break}if(L=D[U],!(null===(A=L.Task)||void 0===A||null===(F=A.resource)||void 0===F?void 0:F.id)){e.next=82;break}return e.next=80,De("".concat(P,"/Task/").concat(null===(q=L.Task)||void 0===q||null===(M=q.resource)||void 0===M?void 0:M.id));case 80:(B=e.sent)&&(L.trackingItem=B);case 82:U++,e.next=75;break;case 85:return e.next=87,Pe();case 87:return(null===(z=e.sent)||void 0===z?void 0:z.length)>0&&l.forEach((function(e,t){e.Consent=z})),console.log("referral list",l),l.sort((function(e,t){var n=new Date(e.ServiceRequest.resource.authoredOn).getTime();return new Date(t.ServiceRequest.resource.authoredOn).getTime()-n})),ge("100%"),e.abrupt("return",l);case 93:case"end":return e.stop()}}),e,null,[[30,41,44,47]])})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a,s,i,o=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:h.fhirId,n=o.length>1&&void 0!==o[1]?o[1]:P,r=n+"/Encounter?patient="+t,e.next=5,fetch(r,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json",Authorization:(null===I||void 0===I?void 0:I.length)>0&&"Logica"!==c.substring(0,6)?"bearer "+I:""}});case 5:return a=e.sent,e.next=8,a.json();case 8:return s=e.sent,(i=s.total>0?s.entry:[]).sort((function(e,t){var n,r,a,c,s=new Date(null===(n=e.resource)||void 0===n||null===(r=n.period)||void 0===r?void 0:r.start).getTime();return new Date(null===(a=t.resource)||void 0===a||null===(c=a.period)||void 0===c?void 0:c.start).getTime()-s})),console.log("encounter",i),e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=P+"/Communication?part-of="+t,e.next=3,fetch(n,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json",Authorization:(null===I||void 0===I?void 0:I.length)>0&&"Logica"!==c.substring(0,6)?"bearer "+I:""}});case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,console.log("communications: ",a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(fe,"/mockapi/communication/read"),e.next=3,fetch(r,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":be.token},body:JSON.stringify({fullUrl:P+"/Communication/"+t})});case 3:return a=e.sent,e.next=6,a.json();case 6:return c=e.sent,s=null===c||void 0===c||null===(n=c.response)||void 0===n?void 0:n.item,console.log("check communication ",t," result ",void 0===s),e.abrupt("return",void 0===s);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,s,o,l,u,b,j,p;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],s=null===t||void 0===t||null===(n=t.ServiceRequest)||void 0===n||null===(r=n.resource)||void 0===r?void 0:r.supportingInfo){e.next=4;break}return e.abrupt("return",a);case 4:o=Object(i.a)(s),e.prev=5,o.s();case 7:if((l=o.n()).done){e.next=20;break}return u=l.value,b=P+"/"+u.reference,e.next=12,fetch(b,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json",Authorization:(null===I||void 0===I?void 0:I.length)>0&&"Logica"!==c.substring(0,6)?"bearer "+I:""}});case 12:return j=e.sent,e.next=15,j.json();case 15:p=e.sent,console.log("documentReference: ",p),"DocumentReference"===(null===p||void 0===p?void 0:p.resourceType)&&a.push(p);case 18:e.next=7;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),o.e(e.t0);case 25:return e.prev=25,o.f(),e.finish(25);case 28:return e.abrupt("return",a);case 29:case"end":return e.stop()}}),e,null,[[5,22,25,28]])})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,s,o,l,u,b,j;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],t){e.next=3;break}return e.abrupt("return",n);case 3:r=Object(i.a)(t),e.prev=4,r.s();case 6:if((a=r.n()).done){e.next=18;break}return l=a.value,u=P+"/"+(null===(s=l.content[0])||void 0===s||null===(o=s.attachment)||void 0===o?void 0:o.url),e.next=11,fetch(u,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/fhir+json",Authorization:(null===I||void 0===I?void 0:I.length)>0&&"Logica"!==c.substring(0,6)?"bearer "+I:""}});case 11:return b=e.sent,e.next=14,b.json();case 14:"Binary"===(null===(j=e.sent)||void 0===j?void 0:j.resourceType)&&n.push(j);case 16:e.next=6;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),r.e(e.t0);case 23:return e.prev=23,r.f(),e.finish(23);case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e,null,[[4,20,23,26]])})));return function(t){return e.apply(this,arguments)}}(),Pe=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a,s,i,o=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:h.fhirId,n=o.length>1&&void 0!==o[1]?o[1]:"Logica"===c||"Logica2"===c?"64292-6":"http://loinc.org|64292-6",r=o.length>2&&void 0!==o[2]?o[2]:"active",a="".concat(P,"/Consent?patient=").concat(t,"&category=").concat(n,"&status=").concat(r),e.next=6,fetch(a,{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json",Authorization:(null===I||void 0===I?void 0:I.length)>0&&"Logica"!==c.substring(0,6)?"bearer "+I:""}});case 6:return s=e.sent,e.next=9,s.json();case 9:return i=e.sent,console.log("consent: ",i),e.abrupt("return",i.entry);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,r,a,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(fe,"/mockapi/resource_tracking/read"),e.next=3,fetch(r,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":be.token},body:JSON.stringify({full_url:t})});case 3:return a=e.sent,e.next=6,a.json();case 6:return c=e.sent,s=null===(n=c.response)||void 0===n?void 0:n.item,console.log("Found item: ",s),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(u.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge("0%"),ae(ee),oe(!0),C(t),e.next=6,Fe(t,n);case 6:return oe(!1),ge("0%"),e.abrupt("return");case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(u.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(t,n);case 2:r=e.sent,G(r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Le=function(){var e=Object(u.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge("0%"),oe(!0),e.next=4,Te(t,n);case 4:return r=e.sent,V(r),oe(!1),ge("0%"),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qe=function(){var e=Object(u.a)(d.a.mark((function e(t,n){var r,a,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ae("Sending ".concat(n," notification to Unite Us ... ")),ge("25%"),oe(!0),r={resourceType:"Bundle",type:"Event",entry:[{fullUrl:P+"/"+n+"/"+t}]},a="".concat(fe,"/FhirNotificationWebService"),e.next=7,fetch(a,{method:"POST",headers:{"Content-type":"application/json","x-api-key":be.token},body:JSON.stringify(r)});case 7:return c=e.sent,ge("80%"),e.next=11,c.json();case 11:return s=e.sent,console.log("notification response: ",s),ge("100%"),ae(s.statusCode+": "+s.message),ge("hide"),e.abrupt("return",s);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Me=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ae("Sending encounter notification to Unite Us ... "),ge("25%"),oe(!0),t="".concat(fe,"/FhirNotificationWebService"),n={resourceType:"Bundle",type:"Event",entry:[{fullUrl:P+"/Encounter/"+S}]},e.next=7,fetch(t,{method:"POST",headers:{"Content-type":"application/json","x-api-key":be.token},body:JSON.stringify(n)});case 7:return r=e.sent,ge("80%"),e.next=11,r.json();case 11:return a=e.sent,console.log("notification response: ",a),ge("100%"),ae(a.statusCode+": "+a.message),ge("hide"),e.abrupt("return",a);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=Object(u.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(fe,"/mockapi/authentication/token"),e.next=3,fetch(t,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":be.token},body:JSON.stringify({privateKey:null})});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,a=r.body.access_token,console.log("access token ",a),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=Object(u.a)(d.a.mark((function e(t,n){var r,a,s,i,o,l,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("new status: ",n),ge("0%"),ae("Updating Task Status ..."),oe(!0),r="".concat(fe,"/mockapi/request/read"),e.next=7,fetch(r,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":be.token},body:JSON.stringify({baseUrl:P,resourceType:"Task",resourceId:t})});case 7:return a=e.sent,e.next=10,a.json();case 10:return s=e.sent,i=s.response.body,o=s.response.headers,l="Logica"===c||"Logica2"===c?o.etag[0]:o["e-tag"][0],console.log("task: ",i),console.log("headers",o),ge("5%"),i.status=n.value,u=_e(n.rejectReason.reason.text),"rejected"===n.value&&(i.statusReason={coding:[{system:"Logica"===c.substring(0,6)?"HTTPS://UNITEUS.COM/IO/STRUCTUREDEFINITION/STATUS-REASON":"urn:oid:1.2.840.114350.1.13.0.1.7.4.698084.34025",code:u.code,display:u.display}],text:"".concat(n.rejectReason.reason.value,". ").concat(n.rejectReason.note)}),console.log("new task: ",i),r="".concat(fe,"/mockapi/request/update"),e.next=24,fetch(r,{method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-api-key":be.token},body:JSON.stringify({baseUrl:P,resourceType:"Task",resourceId:t,etag:l,resource:i})});case 24:return a=e.sent,ge("10%"),ae("Retrieving FHIR Resources ..."),e.next=29,Fe(S,P);case 29:return oe(!1),ge("0%"),e.abrupt("return");case 32:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_e=function(e){switch(e){case"Not Eligible":return{system:"urn:oid:1.2.840.114350.1.13.0.1.7.4.698084.34025",code:"104",display:"Patient does not meet the level of care required for admission"};case"No Capacity":return{system:"urn:oid:1.2.840.114350.1.13.0.1.7.4.698084.34025",code:"101",display:"Facility Full"};case"Do Not Provide Service":return{system:"urn:oid:1.2.840.114350.1.13.0.1.7.4.698084.34025",code:"103",display:"Facility cannot provide for patient's needs"};case"Duplicate":case"Unable to Contact Client":case"Other":default:return{system:"urn:oid:1.2.840.114350.1.13.0.1.7.4.698084.34025",code:"99",display:"Other (Comment)"}}};return Object(r.useEffect)((function(){(function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(t)}),[]),Object(r.useEffect)((function(){(function(){var e=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[I]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(x,{patient:h,provider:O,profileName:c,switchProfile:ye,stageName:be.name,switchStage:ke}),Object(p.jsxs)("div",{className:ie?"error"===xe?"toast bg-danger text-secondary show":"hide"===xe?"toast bg-info text-secondary show":"toast bg-warning text-secondary show":"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",id:"messageToast",children:[Object(p.jsxs)("div",{className:"toast-header",children:["error"===xe?Object(p.jsx)("strong",{className:"me-auto",children:"Error"}):"hide"===xe?Object(p.jsx)("strong",{className:"me-auto",children:"Success"}):Object(p.jsx)("strong",{className:"me-auto",children:"Please Wait ..."}),Object(p.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"messageToast","aria-label":"Close",onClick:function(){oe(!1)}})]}),Object(p.jsxs)("div",{className:"toast-body",children:[re,"hide"===xe||"error"===xe?null:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"spinner-border text-warning",role:"status",children:Object(p.jsx)("span",{className:"visually-hidden",children:"..."})}),Object(p.jsx)("div",{className:"progress my-2",children:Object(p.jsx)("div",{className:"progress-bar bg-warning progress-bar-striped progress-bar-animated",role:"progressbar",style:{width:xe},"aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"})})]})]})]}),Object(p.jsx)("div",{className:"container-fluid px-0",children:Object(p.jsxs)("div",{className:"row mt-0 mx-0",children:[Object(p.jsx)(N,{encounterList:Z,currentEncounter:S,changeCurrentEncounter:Ae,refreshEncounters:Le}),Object(p.jsx)(F,{onCreate:Ce,referralList:J,currentEncounter:S,sendNotificationUU:Me,profileName:c,updateReferralStatus:ze,baseUrl:P,sendUUNotification:qe,currentStage:be})]})})]})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(42);s.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(H,{})}),document.getElementById("root")),J()}},[[43,1,2]]]);
//# sourceMappingURL=main.e38eb245.chunk.js.map